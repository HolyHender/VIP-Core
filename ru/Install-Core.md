# Установка и настройка ядра

> Все файлы сохраняйте в кодировке UTF-8 Без BOM Редактором [Notepad++](https://notepad-plus-plus.org/download/)

### Общая информация
Плагин имеет модульную структуру. Это значит что основную работу выполняет **ядро**, а функционал выполняют **модули**.
Ядро управляет всеми VIP-игроками, конфигами, базами данных, обрабатывает команды, а модули добавляют в систему различные возможности.
Плагин может работать с локальной базой SQL и удаленной базой MySQL


## Установка ядра

1. Скачиваем архив с файлами с темы [HLMod.ru](https://hlmod.ru/resources/vip-core.245/) или [GitHub Releases](https://github.com/R1KO/VIP-Core/releases) или исходники [GitHub](https://github.com/R1KO/VIP-Core/) (не забываем скомпилировать)
2. Распаковываем архив и раскидываем файлы по папкам на сервере.
3. Устанавливаем последнюю версию переводов для модулей с [темы на HLMod.ru](https://hlmod.ru/resources/vip-translations-vip-module.938/)
4. Если хотите использовать MySQL базу, необходимо в `databases.cfg` прописать:
```
  "vip_core"
  {
      "driver"        "mysql"
      "host"            "ip"        // ip сервера где находится ваш mysql
      "database"        "vip"        // название базы данных
      "user"            "root"        // имя пользователя базы данных
      "pass"            "pass"        // пароль для этого пользователя
  }
  ```
При использовании SQLite базы она будет храниться по пути: `addons/sourcemod/data/sqlite/vip_core.sq3`

5. Запустить сервер и убедиться что плагин запустился и в логах нет ошибок
6. Настроить конфиг `cfg/vip/VIP_Core.cfg` (создастся автоматически при первом запуске)
7. Установить необходимые модули [Как устанавливать модули?](ru/Install-Modules.md)


## Настройка ядра

### Расположение файлов и их описание

- `addons/sourcemod/data/vip/cfg/`
    - `groups.ini` - Настройки возможностей VIP-групп
    - `times.ini` - Настройки времени в админ-меню
    - `sort_menu.ini` - Сортировка пунктов в VIP-меню
    - `info.ini` - Настройка информационных сообщений

- `addons/sourcemod/data/vip/modules/`
    - `downloadlist.txt` - Списком файлов для загрузки игрокам
    - `...` - Конфиги модулей

- `addons/sourcemod/plugins/vip/`
    - `VIP_Core.smx` - Основной плагин-ядро
    - `...` - Модули

- `addons/sourcemod/translations/`
    - `vip_core.phrases.txt` - Файл перевода ядра
    - `vip_modules.phrases.txt` - Файл перевода модулей
    - `...` - другие файлы переводов модулей

- `cfg/vip/`
    - `VIP_Core.cfg` - Файл с основными настройками ядра
    - `...` - другие файлы пс настройками модулей


### Настройка информационных сообщений

Вся информация и примеры описаны в файле `addons/sourcemod/data/vip/cfg/info.ini`
Если вы хотите убрать полностью какое-то сообщение - удалите соответствующий ему раздел из файла

### Настройка сортировки пунктов в VIP-меню
Настраивается в `addons/sourcemod/data/vip/cfg/sort_menu.ini`
Вписываете в нужном порядке уникальные имена функций и подменю.
Пример:
```
HP
Armor
Money
Speed
```
Всё что не вписано в данный файл будет идти поле отсортированых пунктов в случайном порядке.

### Настройка VIP-групп

```
"VIP_GROUPS"
{
    "vip1" // Имя группы
    {
        // Параметры
        "HP"            "120"    // Сколько хп будет при спавне
        "Armor"            "100"    // Сколько брони будет при спавне
        "Money"            "16000"    // Сколько денег будет при спавне
        "QuickDefuse"    "1"        // Включает опцию быстрого дефуза
        "Speed"            "1.3"    // Дает установленную скорость (1.0 - норма)
        "RegenHP"        "5"        // Сколько едениц хп в секунду будет восстанавливаться
        "RegenArmor"    "5"        // Сколько едениц брони в секунду будет восстанавливаться
    }

    "vip2" // Имя группы
    {
        // Параметры
        "HP"            "120"    // Сколько хп будет при спавне
        "Speed"            "1.3"    // Дает установленную скорость (1.0 - норма)
        "RegenHP"        "5"        // Сколько едениц хп в секунду будет восстанавливаться
        "RegenArmor"    "5"        // Сколько едениц брони в секунду будет восстанавливаться
    }
}
```

### Сортировки пунктов админ меню

Для сортировки пунктов админ меню в `addons/sourcemod/configs/adminmenu_sorting.txt` добавьте

```
"vip_admin"
{
    "item"        "add_vip"
    "item"        "edit_vip"
    "item"        "del_vip"
    "item"        "list_vip"
    "item"        "reload_vip_players"
    "item"        "reload_vip_cfg"
}
```

### Расширенные настройки

#### Включение/отключение режима отладки
Для этого в файле `VIP_Core.sp` находим строку:
```
#define DEBUG_MODE 		0
```
Меняем 0 на 1 и компилируем

#### Скрытие раздела управления VIP из админ меню
Для этого в файле `VIP_Core.sp` находим строку:
```
#define USE_ADMINMENU 		1
```
Меняем 1 на 0 и компилируем


#### Режим работы VIP на всех серверах с одной базой данных
Для этого в файле `VIP_Core.sp` находим строку:
```
#define USE_MORE_SERVERS 		1
```
1 - Включить / 0 - Отключить режим при котором если ID сервера у игрока 0 - то VIP будет работать на всех серверах

